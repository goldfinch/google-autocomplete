(function(r){window.googleFieldsInit=()=>{};function f(a,l,o,n,c){o.value=l.lat(),n.value=l.lng(),c.value=a.getZoom()}function h(a,l,o,n,c,i){var e=r(o.currentTarget).val();e&&(geocoder=new google.maps.Geocoder,geocoder.geocode({address:e},(p,t)=>{if(google.maps.GeocoderStatus.OK===t){let d=p[0].geometry.location;l.setPosition(d),a.panTo(d),f(a,d,n,c,i)}else console.warn("Find a place: "+e+" not found")})),o.preventDefault(),o.stopPropagation()}function u(){r("[data-goldfinch-google-place-field]").each((a,l)=>{let o=r(l).find('[data-goldfinch-place="data"]');if(o.length&&o.val()){let n=JSON.parse(r(l).find('[data-goldfinch-place="data"]').val()),c=r(l).find('[data-goldfinch-place="preview"]'),i=r("<ul>");n.address_components.forEach((e,p)=>{let t=e.types.join();e.types.includes("subpremise")?t="Subpremise":e.types.includes("street_number")?t="Street number":e.types.includes("route")?t="Street name":e.types.includes("locality")?t="Suburb":e.types.includes("sublocality")?t="Subarea":e.types.includes("administrative_area_level_1")?t="Region":e.types.includes("administrative_area_level_2")?t="District":e.types.includes("country")?t="Country":e.types.includes("postal_code")&&(t="Postcode"),i.append("<li><b>"+t+"</b>: "+e.long_name+"</li>")});let s=n.geometry.location;i.append("<li><b>Latitude</b>: "+s.lat+"</li>"),i.append("<li><b>Longitude</b>: "+s.lng+"</li>"),i.append('<li><a target="_blank" href="https://www.google.com/maps/search/?api=1&query='+s.lat+","+s.lng+'">Open Google Maps</a></li>'),c.html(i)}})}r(document).ready(()=>{u()}),r.entwine("ss",function(a){a("[data-goldfinch-google-place-field]").entwine({onmatch:function(){var l=a(this).find('[data-goldfinch-place="address"]')[0],o=a(this).find('[data-goldfinch-place="data"]')[0],n=JSON.parse(a(l).attr("data-settings"));console.log(n);const c={componentRestrictions:{country:n.country},fields:["address_components","geometry","name"],strictBounds:!1},i=new google.maps.places.Autocomplete(l,c);i.addListener("place_changed",()=>{const s=i.getPlace();o.value=JSON.stringify(s),u()})}}),a("[data-goldfinch-google-map-field]").entwine({onmatch:function(){var l=a(this).find('[data-goldfinch-map="latitude"]')[0],o=a(this).find('[data-goldfinch-map="longitude"]')[0],n=a(this).find('[data-goldfinch-map="zoom"]')[0],c=a(this).find('[data-goldfinch-map="frame"]')[0],i=a(this).find('[data-goldfinch-map="search"]')[0],s=JSON.parse(a(c).attr("data-settings"));let e=parseFloat(l.value),p=parseFloat(o.value),t=parseFloat(n.value);t||(t=s.zoom),e||(e=s.lat),p||(p=s.lng);let d=new google.maps.Map(c,{center:{lat:e,lng:p},zoom:t,gestureHandling:"cooperative",fullscreenControl:!1,mapTypeControl:!1,clickableIcons:!1,rotateControl:!1,scaleControl:!1,streetViewControl:!1,zoomControl:!1});var m=new google.maps.Marker({position:{lat:e,lng:p},map:d});google.maps.event.addListener(d,"zoom_changed",g=>{n.value=d.getZoom()}),google.maps.event.addListener(d,"click",g=>{m.setPosition(g.latLng),d.panTo(g.latLng),f(d,g.latLng,l,o,n)}),a(i).on({change:i,keydown:g=>{g.which==13&&h(d,m,g,l,o,n)}})}})})})(jQuery);
